function Piece(e){if(null!==e){var n=function(){return e.getBoundingClientRect()};return{dom:e,top:n().top,left:n().left,right:n().right,bottom:n().bottom,center:{x:(n().right+n().left)/2,y:(n().bottom+n().top)/2}}}}var Board=function(){return{getPieces:function(){for(var e=[],n=document.getElementsByClassName("piece"),t=0;t<n.length;t++)e.push(Piece(n[t]));return e},getChosen:function(){return Piece(document.getElementsByClassName("chosen")[0])},getPieceByNumber:function(e){for(var n=this.getPieces(),t=0;t<n.length;t++)if(n[t].dom.innerHTML==e)return n[t];return n[0]},getEmpty:function(){return Piece(document.getElementsByClassName("empty")[0])},getPieceSize:function(e){for(var n=0,t=this.getPieces(),o=0;o<t.length-1;o++)if(n=Math.abs(t[o][e]-t[o+1][e]),n>0)return n;return 0},getPieceHeight:function(){return this.getPieceSize("top")},getPieceWidth:function(){return this.getPieceSize("left")},getSideBoundary:function(e,n){for(var t=this.getPieces(),o=t[0][e],i=0;i<t.length;i++)n(o,t[i][e])&&(o=t[i][e]);return o},getTopBoundary:function(){return this.getSideBoundary("top",function(e,n){return e>n})},getBottomBoundary:function(){return this.getSideBoundary("bottom",function(e,n){return e<n})},getLeftBoundary:function(){return this.getSideBoundary("left",function(e,n){return e>n})},getRightBoundary:function(){return this.getSideBoundary("right",function(e,n){return e<n})},exceedsTopBoundary:function(e){return e.top<=this.getTopBoundary()},exceedsBottomBoundary:function(e){return e.bottom>=this.getBottomBoundary()},exceedsLeftBoundary:function(e){return e.left==this.getLeftBoundary()},exceedsRightBoundary:function(e){return e.right==this.getRightBoundary()},getPieceOneUp:function(e){if(!this.exceedsTopBoundary(e)){var n=e.center.x,t=e.center.y-Board.getPieceHeight();return Piece(document.elementFromPoint(n,t))}},getPieceOneDown:function(e){if(!this.exceedsBottomBoundary(e)){var n=e.center.x,t=e.center.y+Board.getPieceHeight();return Piece(document.elementFromPoint(n,t))}},getPieceOneLeft:function(e){if(!this.exceedsLeftBoundary(e)){var n=e.center.x-Board.getPieceWidth(),t=e.center.y;return Piece(document.elementFromPoint(n,t))}},getPieceOneRight:function(e){if(!this.exceedsRightBoundary(e)){var n=e.center.x+Board.getPieceWidth(),t=e.center.y;return Piece(document.elementFromPoint(n,t))}}}}(),Randomizer=function(){var e=function(e){return Math.floor(Math.random()*e)},n=function(n){if(p=n(Board.getEmpty()),p)for(i=0;i<e(3);i++)p=n(Board.getEmpty());return p},t=function(){var e;return(e=n(function(e){return Board.getPieceOneUp(e)}))?e:(e=n(function(e){return Board.getPieceOneDown(e)}))?e:(e=n(function(e){return Board.getPieceOneLeft(e)}))?e:e=n(function(e){return Board.getPieceOneRight(e)})},o=function(){var e;return(e=n(function(e){return Board.getPieceOneUp(e)}))?e:(e=n(function(e){return Board.getPieceOneDown(e)}))?e:(e=n(function(e){return Board.getPieceOneLeft(e)}))?e:(e=n(function(e){return Board.getPieceOneRight(e)}))?e:(e=n(function(e){return Board.getPieceOneUp(e)}))?e:e=n(function(e){return Board.getPieceOneDown(e)})};return{getRandom:function(n){return e(n)},getRandomPieceNearEmpty:function(){var n;switch(e(2)){case 1:n=t();break;case 2:n=o()}return n}}}(),Cursor=function(){return{moveOneSpace:function(e){var n=Board.getChosen(),t=e(n);void 0!==t&&(n.dom.classList.remove("chosen"),t.dom.classList.add("chosen"))},moveCursorOneUp:function(){this.moveOneSpace(function(e){return Board.getPieceOneUp(e)})},moveCursorOneLeft:function(){this.moveOneSpace(function(e){return Board.getPieceOneLeft(e)})},moveCursorOneRight:function(){this.moveOneSpace(function(e){return Board.getPieceOneRight(e)})},moveCursorOneDown:function(){this.moveOneSpace(function(e){return Board.getPieceOneDown(e)})},moveTileOne:function(e,n){var t,o=n(e);void 0!==o&&(t=e.dom.innerHTML,e.dom.innerHTML=o.dom.innerHTML,o.dom.innerHTML=t)},moveTileUpOne:function(e){this.moveTileOne(e,function(e){return Board.getPieceOneUp(e)})},moveTileLeftOne:function(e){this.moveTileOne(e,function(e){return Board.getPieceOneLeft(e)})},moveTileRightOne:function(e){this.moveTileOne(e,function(e){return Board.getPieceOneRight(e)})},moveTileDownOne:function(e){this.moveTileOne(e,function(e){return Board.getPieceOneDown(e)})},moveTiles:function e(n,t,o){if(void 0!==o||(o=Board.getChosen(),!o.dom.classList.contains("empty"))){var i=n(o);if(void 0!==i)return e(n,t,i),i.dom.classList.contains("empty")?(t(o),o.dom.classList.add("empty"),i.dom.classList.remove("empty"),o):void 0}},moveTilesRight:function(){var e=this,n=function(e){return Board.getPieceOneRight(e)},t=function(n){return e.moveTileRightOne(n)};this.moveTiles(n,t)},moveTilesLeft:function(){var e=this,n=function(e){return Board.getPieceOneLeft(e)},t=function(n){return e.moveTileLeftOne(n)};this.moveTiles(n,t)},moveTilesUp:function(){var e=this,n=function(e){return Board.getPieceOneUp(e)},t=function(n){return e.moveTileUpOne(n)};this.moveTiles(n,t)},moveTilesDown:function(){var e=this,n=function(e){return Board.getPieceOneDown(e)},t=function(n){return e.moveTileDownOne(n)};this.moveTiles(n,t)},makeChosen:function(e){if(void 0!==e){var n=Board.getChosen();n.dom.classList.remove("chosen"),e.dom.classList.add("chosen")}},moveTilesRandomly:function(){var e,n;document.getElementById("menu").classList.add("no-display");for(var t=0;t<100;t++)n=Randomizer.getRandomPieceNearEmpty(),this.makeChosen(n),e=this.moveTilesUp(),void 0===e&&(e=this.moveTilesDown(),void 0===e&&(e=this.moveTilesLeft(),void 0===e&&(e=this.moveTilesRight(),void 0===e&&this.makeChosen(Board.getPieceByNumber(Randomizer.getRandom(15))))))}}}(),Keys=function(){var e=!1;return{listen:function(){window.onkeyup=function(n){32==n.keyCode&&(n.preventDefault(),e=!1)},window.onkeydown=function(n){var t,o,i=!1,r=function(n,t,o){n.preventDefault(),e&&o(),t()};switch(n.keyCode){case 32:n.preventDefault(),e=!0;break;case 37:t=function(){Cursor.moveCursorOneLeft()},o=function(){Cursor.moveTilesLeft()},i=!0;break;case 38:t=function(){Cursor.moveCursorOneUp()},o=function(){Cursor.moveTilesUp()},i=!0;break;case 39:t=function(){Cursor.moveCursorOneRight()},o=function(){Cursor.moveTilesRight()},i=!0;break;case 40:t=function(){Cursor.moveCursorOneDown()},o=function(){Cursor.moveTilesDown()},i=!0}i&&r(n,t,o)}},start:function(){var e=function(){Cursor.moveTilesRandomly(),window.removeEventListener("click",e,!1)};window.addEventListener("click",e,!1)}}}();